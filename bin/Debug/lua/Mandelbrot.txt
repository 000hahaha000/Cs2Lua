require "cs2dsl__utility";
require "cs2dsl__namespaces";
require "cs2dsl__externenums";

Mandelbrot = {
	__new_object = function(...)
		return newobject(Mandelbrot, nil, nil, ...);
	end,
	__define_class = function()
		local static = Mandelbrot;
		local static_methods = {
			Test = function()
				newobject(Mandelbrot, "ctor", nil):Exec();
			end,
			cctor = function()
			end,
		};

		local static_fields_build = function()
			local static_fields = {
			};
			return static_fields;
		end;
		local static_props = nil;
		local static_events = nil;

		local instance_methods = {
			Exec = function(this)
				local width;
				width = 50;
				local height;
				height = width;
				local maxiter;
				maxiter = 50;
				local limit;
				limit = 4.00;
				local y;
				y = 0;
				while (y < height) do
					local Ci;
					Ci = (((2.00 * y) / height) - 1.00);
					local x;
					x = 0;
					while (x < width) do
						local Zr;
						Zr = 0.00;
						local Zi;
						Zi = 0.00;
						local Cr;
						Cr = (((2.00 * x) / width) - 1.50);
						local i;
						i = maxiter;
						local isInside;
						isInside = true;
						repeat

							local Tr;
							Tr = (((Zr * Zr) - (Zi * Zi)) + Cr);
							Zi = (((2.00 * Zr) * Zi) + Ci);
							Zr = Tr;
							if (((Zr * Zr) + (Zi * Zi)) > limit) then 
								isInside = false;
								break;
							end;
						until not (						((function()
							i = invokeintegeroperator(3, "-", i, 1, System.Int32, System.Int32);
							return i;
						end)() > 0)) ;
						if isInside then 
							this:Output(((x * 1.00) / width), ((y * 1.00) / height));
						end;
						x = invokeintegeroperator(2, "+", x, 1, System.Int32, System.Int32);
					end;
					y = invokeintegeroperator(2, "+", y, 1, System.Int32, System.Int32);
				end;
			end,
			Output = function(this, x, y)
				JsConsole.Print(x, y);
			end,
			ctor = function(this)
			end,
		};
		local instance_fields_build = function()
			local instance_fields = {
				r = 10,
				scale = 3.00,
				datas = arrayinit(1, 2, 3, 4, 5, 6),
				dicts = newexterndictionary(System.Collections.Generic.Dictionary_TKey_TValue, "System.Collections.Generic.Dictionary_TKey_TValue", "ctor", dictionaryinit(11, 22, 33, 44, 55)),
				dicts2 = newexterndictionary(System.Collections.Generic.Dictionary_TKey_TValue, "System.Collections.Generic.Dictionary_TKey_TValue", "ctor", dictionaryinit(), 128),
			};
			return instance_fields;
		end;
		local instance_props = nil;
		local instance_events = nil;

		local interfaces = nil;
		local interface_map = nil;

		return defineclass(nil, "Mandelbrot", static, static_methods, static_fields_build, static_props, static_events, instance_methods, instance_fields_build, instance_props, instance_events, interfaces, interface_map, false);
	end,
};

Mandelbrot.__define_class();
